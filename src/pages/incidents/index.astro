---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CardGrid from "../../components/CardGrid.astro";
import CardItem from "../../components/CardItem.astro";
import PageIntro from "../../components/PageIntro.astro";
import SectionBlock from "../../components/SectionBlock.astro";
import { incidentLessons, incidentLessonsIntro } from "../../content/incidents";

const { pageTitle, pageDescription, permalink, eyebrow, title, description } =
  incidentLessonsIntro;
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <PageIntro
    eyebrow={eyebrow}
    title={title}
    description={description}
    permalink={permalink}
    anchorLinks={incidentLessons.map((lesson) => ({
      href: `#${lesson.slug}`,
      label: lesson.title,
    }))}
    panelCopy={{
      eyebrow: "How to use these",
      title: "Trace the governance gap, then apply the checklist.",
      description:
        "Each lesson links to the signals to monitor and the remediation actions to implement before the next incident.",
    }}
  />

  <SectionBlock
    eyebrow="Incident lessons"
    title="Browse the retrospectives."
    description="Start with the headline and impact, then open the full checklist for execution guidance."
    className="section--banded"
  >
    <CardGrid className="grid--two">
      {incidentLessons.map((lesson) => (
        <CardItem
          id={lesson.slug}
          title={lesson.title}
          description={lesson.summary}
          descriptionTone="default"
        >
          <ul class="muted">
            <li>{lesson.incident.sector}</li>
            <li>{lesson.incident.timeframe}</li>
          </ul>
          <div slot="footer" class="card__footer">
            <a class="button ghost button--compact" href={`/incidents/${lesson.slug}`}>
              Open lesson
            </a>
          </div>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>
</BaseLayout>
