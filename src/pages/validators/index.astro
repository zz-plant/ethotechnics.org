---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageIntro from "../../components/PageIntro.astro";
import CardGrid from "../../components/CardGrid.astro";
import CardItem from "../../components/CardItem.astro";
import { validatorsContent } from "../../content/validators";

const {
  pageTitle,
  pageDescription,
  permalink,
  anchorLinks,
  panelCopy,
  validators,
  method,
} = validatorsContent;
const pageUrl = Astro.site
  ? new URL(permalink, Astro.site).toString()
  : permalink;
const validatorUrl = (slug: string) =>
  Astro.site
    ? new URL(`/validators/${slug}`, Astro.site).toString()
    : `/validators/${slug}`;
const structuredData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "@id": pageUrl,
  name: pageTitle,
  description: pageDescription,
  url: pageUrl,
  hasPart: validators.map((validator) => ({
    "@type": "CreativeWork",
    name: `${validator.id} â€” ${validator.title}`,
    description: validator.description,
    url: validatorUrl(validator.slug),
    identifier: validator.id,
  })),
};
const structuredDataJson = JSON.stringify(structuredData, null, 2);
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <PageIntro
    eyebrow="Validators"
    title="Validators"
    description="Run diagnostic validators that output report cards and corrective mechanisms."
    permalink={permalink}
    anchorLinks={anchorLinks}
    panelCopy={panelCopy}
  />

  <section id="tools" class="section">
    <CardGrid className="grid--two">
      {
        validators.map((validator) => (
          <CardItem
            eyebrow={validator.id}
            title={validator.title}
            description={validator.description}
          >
            <a
              slot="footer"
              class="muted"
              href={`/validators/${validator.slug}`}
            >
              Run {validator.title}
            </a>
          </CardItem>
        ))
      }
    </CardGrid>
  </section>

  <section id="method" class="section section--alt">
    <div class="section__header">
      <p class="eyebrow">Method</p>
      <h2>{method.title}</h2>
      <p class="muted">{method.description}</p>
    </div>
    <ul class="validator-method">
      {method.steps.map((step) => <li>{step}</li>)}
    </ul>
  </section>
  <script type="application/ld+json" set:html={structuredDataJson} is:inline />
</BaseLayout>
