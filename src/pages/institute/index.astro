---
import CardGrid from '../../components/CardGrid.astro';
import CardItem from '../../components/CardItem.astro';
import InstituteStudioComparison from '../../components/InstituteStudioComparison.astro';
import PageIntro from '../../components/PageIntro.astro';
import QuoteHighlight from '../../components/QuoteHighlight.astro';
import ReferenceCallout from '../../components/ReferenceCallout.astro';
import SectionBlock from '../../components/SectionBlock.astro';
import StatCluster from '../../components/StatCluster.astro';
import StudioBadge from '../../components/StudioBadge.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { instituteStudioCallout } from '../../content/callouts';
import {
  instituteStudioComparisonContent,
  instituteStudioGuidance,
} from '../../content/comparison';
import { instituteContent } from '../../content/institute';

const {
  pageTitle,
  pageDescription,
  permalink,
  anchorLinks,
  panelCopy,
  highlights,
  programs,
  governance,
  stewards,
  contact,
} = instituteContent;
const instituteStats = [
  {
    value: `${highlights.length}`,
    label: 'Engagement paths',
    detail: 'Ways visitors can collaborate with the Institute.',
  },
  {
    value: `${programs.length}`,
    label: 'Active programs',
    detail: 'Tracks running with defined outcomes and status.',
  },
  {
    value: `${governance.length}`,
    label: 'Governance commitments',
    detail: 'Policies that keep releases accountable.',
  },
  {
    value: `${stewards.length}`,
    label: 'Stewards available',
    detail: 'People prepared to triage requests.',
  },
];
---
<BaseLayout title={pageTitle} description={pageDescription}>
  <PageIntro
    eyebrow="Institute"
    title="Institute"
    description={pageDescription}
    permalink={permalink}
    anchorLinks={anchorLinks}
    panelCopy={panelCopy}
  >
    <Fragment slot="actions">
      <a class="button primary" href="#programs">
        View programs
      </a>
      <a class="button ghost" href="#stewards">
        Meet the stewards
      </a>
    </Fragment>
  </PageIntro>
  <SectionBlock
    id="overview"
    eyebrow="What you can do here"
    title="Pick the path that matches your visit."
    description={instituteStudioGuidance.overviewDescription}
    className="section--banded"
  >
    <p class="muted small">
      Note: This Institute is part of ethotechnics.org and is not affiliated with the Institute of
      Ecotechnics (founded in 1973 for ecology and Biosphere 2 work), which typically uses .edu or
      .co.uk domains.
    </p>
    <CardGrid className="grid--two">
      {highlights.map((item) => (
        <CardItem title={item.title} description={item.detail} tags={item.tags} />
      ))}
    </CardGrid>
  </SectionBlock>

  <ReferenceCallout
    title={instituteStudioCallout.title}
    summary={instituteStudioCallout.summary}
    href={instituteStudioCallout.href}
    linkLabel={instituteStudioCallout.linkLabel}
    ariaLabel={instituteStudioCallout.ariaLabel}
  />
  <StudioBadge />

  <SectionBlock
    eyebrow="Institute signal"
    title="A clear view of what is active and accountable."
    description="These metrics summarize how the Institute stays responsive to contributors and program partners."
    className="section--banded"
  >
    <StatCluster items={instituteStats} />
    <QuoteHighlight
      quote="We publish governance alongside delivery so every release earns its credibility in the open."
      attribution="Institute steward council"
      context="Ethotechnics program oversight"
    />
  </SectionBlock>

  <SectionBlock
    id="programs"
    eyebrow="Programs"
    title="What is in motion right now."
    description="Join the track that fits your decision window; everything links back to the Library so you can act quickly."
    variant="alt"
  >
    <p class="muted small">Programs refresh on a quarterly cadence. Reach out for current availability.</p>
    <CardGrid>
      {programs.map((program) => (
        <CardItem
          title={program.title}
          description={program.detail}
          descriptionTone="default"
        >
          <p class="muted">{program.outcome}</p>
          <p class="muted small">Status: {program.status}</p>
          <p class="muted small">{program.howToJoin}</p>
          <div slot="footer" class="card__footer">
            <a class="button ghost button--compact" href={program.ctaHref}>
              {program.ctaLabel}
            </a>
          </div>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="studio"
    eyebrow="Studio partnership"
    title="When a diagnostic shows risk, bring in the Studio."
    description={instituteStudioGuidance.escalationDescription}
  >
    <InstituteStudioComparison content={instituteStudioComparisonContent} />
  </SectionBlock>

  <SectionBlock
    id="governance"
    eyebrow="Governance"
    title="How the Institute stays accountable."
    description="Every program comes with documented expectations so visitors know how their input will be used."
    className="section--banded"
  >
    <CardGrid>
      {governance.map((item) => (
        <CardItem title={item.title} description={item.detail} />
      ))}
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="stewards"
    eyebrow="Stewards"
    title="People guiding the work."
    description="Reach out to the steward closest to your question or risk area."
    variant="alt"
  >
    <CardGrid>
      {stewards.map((steward) => (
        <CardItem
          title={steward.name}
          meta={steward.role}
          description={steward.focus}
          descriptionTone="default"
        >
          <div slot="footer" class="card__footer">
            <a class="button ghost button--compact" href={steward.contactHref}>
              {steward.contactLabel}
            </a>
          </div>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="contact"
    eyebrow="Contact"
    title="Get in touch."
    description="Use these channels for Studio escalations, research partnerships, or general questions."
  >
    <CardGrid>
      {contact.map((channel) => (
        <CardItem title={channel.label} description={channel.description}>
          <a slot="footer" href={channel.href}>
            {channel.linkLabel ?? channel.href}
          </a>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>
</BaseLayout>
