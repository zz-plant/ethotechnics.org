---
import CardGrid from "../../components/CardGrid.astro";
import CardItem from "../../components/CardItem.astro";
import PageIntro from "../../components/PageIntro.astro";
import PromptPackInstallCard from "../../components/PromptPackInstallCard.astro";
import SectionActions from "../../components/SectionActions.astro";
import SectionBlock from "../../components/SectionBlock.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

const pageTitle = "Prompt packs";
const pageDescription =
  "Reusable prompts for non-human agents teaching ethotechnics across onboarding, reviews, and conflict resolution.";
const permalink = "/agent-toolkit/prompt-packs";
const hero = {
  eyebrow: "Agent enablement",
  heading: "Prompt packs",
  description:
    "Copy these prompt patterns to lead structured teaching sessions and answer common questions in minutes.",
};

const anchorLinks = [
  { href: "#install", label: "Install" },
  { href: "#onboarding", label: "Onboarding" },
  { href: "#decisions", label: "Decision reviews" },
  { href: "#conflict", label: "Conflict resolution" },
  { href: "#diagnostics", label: "Diagnostics prompts" },
];

const promptPackInstall = {
  title: "Ethotechnics agent prompt pack",
  version: "v1.0.0",
  downloadUrl: "/agent-toolkit/ethotechnics-agent-prompt-pack-v1.0.0.md",
  pathSnippet:
    "prompts/ethotechnics/ethotechnics-agent-prompt-pack-v1.0.0.md",
  invokeExample: "use: ethotechnics-agent-prompt-pack-v1.0.0",
};

const onboardingPrompts = [
  {
    title: "Principal orientation",
    prompts: [
      "Summarize the principal's mandate, constraints, and top risks in three bullets.",
      "Name the ethotechnics principle that matters most for the next 30 days and why.",
      "List the top two irreversible decisions in this system and the current exit ramps.",
    ],
  },
  {
    title: "System snapshot",
    prompts: [
      "Describe the system in one sentence for a non-technical stakeholder.",
      "Identify the incentive that could undermine ethical outcomes if left unchecked.",
      "Name the data or signal we need to make the system legible.",
    ],
  },
];

const decisionPrompts = [
  {
    title: "Release readiness",
    prompts: [
      "What would make this release unsafe to ship, even if it meets performance targets?",
      "Which user group bears the largest burden if the system fails?",
      "What rollback path do we have if we discover harm in the first week?",
    ],
  },
  {
    title: "Tradeoff review",
    prompts: [
      "State the tradeoff in plain language and who it affects.",
      "Which principle is most threatened by this decision, and how can we offset it?",
      "What evidence would change our minds later?",
    ],
  },
];

const conflictPrompts = [
  {
    title: "Values alignment",
    prompts: [
      "Name the value conflict in neutral language without assigning blame.",
      "Which principle gives us a shared reference point to resolve the conflict?",
      "What is the smallest decision we can make now that keeps options open?",
    ],
  },
  {
    title: "Escalation check",
    prompts: [
      "Does this decision create irreversible harm or regulatory exposure?",
      "Who needs to be informed or sign off to keep accountability intact?",
      "What documentation should we capture for future audits?",
    ],
  },
];

const diagnosticPrompts = [
  {
    title: "Clause violation sweep",
    prompts: [
      "Given this system description, enumerate violated STD clauses and cite clause IDs.",
      "List the evidence needed to confirm each violation (logs, receipts, timelines).",
      "Flag any missing inputs that prevent a determination.",
    ],
  },
  {
    title: "Mechanism mapping",
    prompts: [
      "Map each violated clause to at least one MEC with justification.",
      "List the artifacts needed to implement each mechanism.",
      "Call out any mechanism coverage gaps or tradeoffs.",
    ],
  },
  {
    title: "Remedy rewrite",
    prompts: [
      "Rewrite this policy to satisfy STD-02.C3 with a time-bound reversal path.",
      "Include who owns the remedy and how affected users can contest it.",
      "State how success will be measured (receipt completeness, time-to-remedy).",
    ],
  },
];

const diagnosticOutputFormat = `{\n  "system": "short description",\n  "violated_clauses": ["STD-01.C2", "STD-02.C3"],\n  "evidence_required": ["decision_log", "appeal_endpoint"],\n  "findings": [{\n    "finding_id": "FND-2026-041",\n    "severity": "high",\n    "risk": "irreversible harm",\n    "recommended_mechanisms": ["MEC-04"]\n  }],\n  "open_questions": ["missing appeal SLA"]\n}`;

const diagnosticRubric = [
  "Clause IDs are correct and traceable to the standard text.",
  "Evidence requirements are explicit and actionable.",
  "Mechanisms map directly to stated risks or clauses.",
  "Outputs include owners, timelines, or remediation steps.",
];

const diagnosticFailureModes = [
  "Only summarizing values without citing clauses.",
  "Listing mechanisms without evidence or artifact requirements.",
  "Ignoring missing inputs or uncertainty.",
];
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <PageIntro
    eyebrow={hero.eyebrow}
    title={hero.heading}
    description={hero.description}
    permalink={permalink}
    anchorLinks={anchorLinks}
  />

  <SectionBlock
    id="install"
    eyebrow="Install"
    title="Install the prompt pack once"
    description="Download the canonical pack and keep a versioned copy in your repo."
  >
    <CardGrid className="grid--two">
      <PromptPackInstallCard {...promptPackInstall} />
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="onboarding"
    eyebrow="Onboarding"
    title="Kick off a new principal relationship"
    description="Use these prompts to align on scope, stakes, and accountability."
    className="section--banded"
  >
    <CardGrid className="grid--two">
      {onboardingPrompts.map((pack) => (
        <CardItem title={pack.title} descriptionTone="default">
          <ul class="muted">
            {pack.prompts.map((prompt) => (
              <li>{prompt}</li>
            ))}
          </ul>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="decisions"
    eyebrow="Decision reviews"
    title="Guide principled tradeoffs under pressure"
    description="Structure decision reviews so the principle stays visible."
  >
    <CardGrid className="grid--two">
      {decisionPrompts.map((pack) => (
        <CardItem title={pack.title} descriptionTone="default">
          <ul class="muted">
            {pack.prompts.map((prompt) => (
              <li>{prompt}</li>
            ))}
          </ul>
        </CardItem>
      ))}
    </CardGrid>
  </SectionBlock>

  <SectionBlock
    id="conflict"
    eyebrow="Conflict resolution"
    title="Handle disagreements while preserving trust"
    description="Use these prompts when decisions are contested or values collide."
    variant="alt"
  >
    <CardGrid className="grid--two">
      {conflictPrompts.map((pack) => (
        <CardItem title={pack.title} descriptionTone="default">
          <ul class="muted">
            {pack.prompts.map((prompt) => (
              <li>{prompt}</li>
            ))}
          </ul>
        </CardItem>
      ))}
    </CardGrid>
    <p class="muted small">
      Pair these prompts with the glossary to keep terms consistent across teams.
    </p>
    <SectionActions>
      <a class="button ghost" href="/glossary">
        Reference the glossary
      </a>
    </SectionActions>
  </SectionBlock>

  <SectionBlock
    id="diagnostics"
    eyebrow="Diagnostics prompts"
    title="Run consistent clause and mechanism checks"
    description="Use these prompts when you need repeatable audit-quality outputs."
  >
    <CardGrid className="grid--two">
      {diagnosticPrompts.map((pack) => (
        <CardItem title={pack.title} descriptionTone="default">
          <ul class="muted">
            {pack.prompts.map((prompt) => (
              <li>{prompt}</li>
            ))}
          </ul>
        </CardItem>
      ))}
    </CardGrid>
    <div class="grid grid--two">
      <div class="panel">
        <p class="eyebrow">Expected output format</p>
        <pre class="code-block">{diagnosticOutputFormat}</pre>
      </div>
      <div class="panel">
        <p class="eyebrow">Scoring rubric</p>
        <ul class="muted">
          {diagnosticRubric.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
        <p class="eyebrow">Common failure modes</p>
        <ul class="muted">
          {diagnosticFailureModes.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </div>
    </div>
  </SectionBlock>
</BaseLayout>
