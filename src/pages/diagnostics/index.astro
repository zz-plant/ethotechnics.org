---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PageIntro from '../../components/PageIntro.astro';
import { diagnosticsContent } from '../../content/diagnostics';
import { libraryContent } from '../../content/library';

const { pageTitle, pageDescription, permalink, tools, offRampNote } = diagnosticsContent;
const patternBase = `${libraryContent.permalink}#patterns`;
const anchorLinks = tools.map((tool) => ({ href: `#${tool.slug}`, label: tool.title }));
const introDescription = `${pageDescription} These evaluators are public Institute tools under CC BY through the Institute, and Studio uses the same models with bespoke facilitation via ethotechnics.com/studio.`;
const panelDescription = [
  'Result pages repeat the off-ramp so teams know where to escalate through ethotechnics.com/studio.',
  'Patterns referenced in results link back to the Library pattern language for fast follow-up.',
  offRampNote,
].join(' ');
---
<BaseLayout title={pageTitle} description={pageDescription}>
  <PageIntro
    eyebrow="Diagnostics"
    title="Diagnostics"
    description={introDescription}
    permalink={permalink}
    anchorLinks={anchorLinks}
    panelCopy={{
      eyebrow: 'Results and off-ramps',
      title: 'Each tool ships with an off-ramp to ethotechnics.com/studio.',
      description: panelDescription,
    }}
  />

  {tools.map((tool, index) => (
    <section id={tool.slug} class={`section${index % 2 === 0 ? ' section--alt' : ''}`}>
      <div class="section__header">
        <p class="eyebrow">Diagnostic tool</p>
        <h2>{tool.title}</h2>
        <p class="muted">{tool.description}</p>
      </div>
      <div class="section__actions">
        <a class="button primary" href={tool.ctaHref} aria-label={tool.ctaAriaLabel ?? tool.ctaLabel}>
          {tool.ctaLabel}
        </a>
        <a
          class="button ghost"
          href={tool.exampleHref}
          aria-label={`View example outputs for ${tool.title}`}
        >
          {tool.exampleLabel}
        </a>
      </div>
      <div class="grid">
        <article class="card">
          <div class="card__glow" aria-hidden="true" />
          <p class="muted">Readiness</p>
          <ul class="pill-list">
            {tool.readiness.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </article>
        <article class="card">
          <div class="card__glow" aria-hidden="true" />
          <p class="muted">Outputs</p>
          <ul class="pill-list">
            {tool.outputs.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
          <p class="muted">{tool.studioNote}</p>
        </article>
      </div>
      <div class="callout">
        <h3>Pair with pattern language</h3>
        <p class="muted">
          Use this tool alongside <a href={patternBase}>pattern language</a> entries referenced in Library for consistent
          mitigation steps.
        </p>
        <p class="muted">{offRampNote}</p>
      </div>
    </section>
  ))}
</BaseLayout>
